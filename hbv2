-- MINI BLACK HITBOX PANEL

local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local UIS = game:GetService("UserInputService")

local lp = Players.LocalPlayer
local SIZE = 6
local ENABLED = false
local boxes = {}

local gui = Instance.new("ScreenGui", game.CoreGui)
gui.ResetOnSpawn = false

-- PANEL
local panel = Instance.new("Frame", gui)
panel.Size = UDim2.fromOffset(180,75)
panel.Position = UDim2.fromScale(.05,.5)
panel.BackgroundColor3 = Color3.fromRGB(0,0,0)
panel.BorderSizePixel = 0
Instance.new("UICorner",panel).CornerRadius = UDim.new(0,10)

-- TOP BAR
local title = Instance.new("TextLabel",panel)
title.Size = UDim2.new(1,0,0,22)
title.Text = "HITBOX"
title.TextColor3 = Color3.new(1,1,1)
title.BackgroundTransparency = 1
title.TextSize = 13

local status = Instance.new("TextLabel",panel)
status.Position = UDim2.fromOffset(130,2)
status.Size = UDim2.fromOffset(40,18)
status.Text = "OFF"
status.TextColor3 = Color3.fromRGB(255,0,0)
status.BackgroundTransparency = 1
status.TextSize = 12

-- BUTTON
local toggle = Instance.new("TextButton",panel)
toggle.Position = UDim2.fromOffset(10,40)
toggle.Size = UDim2.fromOffset(80,25)
toggle.Text = "POWER"
toggle.BackgroundColor3 = Color3.fromRGB(20,20,20)
toggle.TextColor3 = Color3.new(1,1,1)
toggle.TextSize = 12
Instance.new("UICorner",toggle)

-- SIZE INPUT
local input = Instance.new("TextBox",panel)
input.Position = UDim2.fromOffset(100,40)
input.Size = UDim2.fromOffset(65,25)
input.Text = tostring(SIZE)
input.BackgroundColor3 = Color3.fromRGB(20,20,20)
input.TextColor3 = Color3.new(1,1,1)
input.TextSize = 12
Instance.new("UICorner",input)

-- DRAG
local dragging=false
local start,pos

title.InputBegan:Connect(function(i)
	if i.UserInputType==Enum.UserInputType.Touch then
		dragging=true
		start=i.Position
		pos=panel.Position
	end
end)

title.InputEnded:Connect(function()
	dragging=false
end)

UIS.InputChanged:Connect(function(i)
	if dragging then
		local d=i.Position-start
		panel.Position=UDim2.new(pos.X.Scale,pos.X.Offset+d.X,pos.Y.Scale,pos.Y.Offset+d.Y)
	end
end)

-- HITBOX
local function make(char)
	if boxes[char] then return end
	local hrp=char:WaitForChild("HumanoidRootPart")

	local hb=Instance.new("BoxHandleAdornment")
	hb.Adornee=hrp
	hb.Size=Vector3.new(SIZE,SIZE,SIZE)
	hb.Transparency=0.45
	hb.Color3=Color3.fromRGB(160,160,160)
	hb.AlwaysOnTop=true
	hb.ZIndex=5
	hb.Parent=gui

	local bb=Instance.new("BillboardGui",hrp)
	bb.Size=UDim2.fromOffset(90,18)
	bb.StudsOffset=Vector3.new(0,3,0)
	bb.AlwaysOnTop=true

	local name=Instance.new("TextLabel",bb)
	name.Size=UDim2.fromScale(1,1)
	name.BackgroundTransparency=1
	name.Text=char.Name
	name.TextColor3=Color3.new(1,1,1)
	name.TextStrokeTransparency=0

	boxes[char]={hb,bb}
end

local function clear()
	for _,v in pairs(boxes) do
		if v[1] then v[1]:Destroy() end
		if v[2] then v[2]:Destroy() end
	end
	table.clear(boxes)
end

RunService.RenderStepped:Connect(function()
	if not ENABLED then return end
	for _,p in pairs(Players:GetPlayers()) do
		if p~=lp and p.Character then
			make(p.Character)
		end
	end
end)

toggle.MouseButton1Click:Connect(function()
	ENABLED=not ENABLED
	if ENABLED then
		status.Text="ON"
		status.TextColor3=Color3.fromRGB(0,255,0)
	else
		status.Text="OFF"
		status.TextColor3=Color3.fromRGB(255,0,0)
		clear()
	end
end)

input.FocusLost:Connect(function()
	local n=tonumber(input.Text)
	if n then SIZE=n end
	for _,v in pairs(boxes) do
		if v[1] then
			v[1].Size=Vector3.new(SIZE,SIZE,SIZE)
		end
	end
end)        txt.Text = plr.Name
        txt.TextColor3 = Color3.new(1,1,1)
        txt.TextStrokeTransparency = 0

        Names[plr] = bill
    end)
end

for _,p in pairs(Players:GetPlayers()) do
    addName(p)
end
Players.PlayerAdded:Connect(addName)

-- HITBOX LOOP
task.spawn(function()
    while task.wait(0.4) do
        if Enabled then
            for _,p in pairs(Players:GetPlayers()) do
                if p ~= LP and p.Character and p.Character:FindFirstChild("HumanoidRootPart") then
                    local hrp = p.Character.HumanoidRootPart
                    hrp.CanCollide = false

                    if not Boxes[p] then
                        local box = Instance.new("BoxHandleAdornment")
                        box.Adornee = hrp
                        box.AlwaysOnTop = true
                        box.ZIndex = 10
                        box.Color3 = Color3.fromRGB(160,160,160)
                        box.Transparency = 0.4 -- visible pero no s√≥lido
                        box.Parent = hrp
                        Boxes[p] = box
                    end

                    Boxes[p].Size = Vector3.new(HitboxSize,HitboxSize,HitboxSize)
                end
            end
        end
    end
end)
